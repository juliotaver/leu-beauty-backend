🔥 Inicializando DeviceRegistrationService
🔍 Verificando acceso a Firestore para la colección: deviceRegistrations
🚀 Server running on port 3001
🌍 Environment: production
📍 Rutas disponibles:
DELETE /v1/devices/:deviceLibraryIdentifier/registrations/:passTypeIdentifier/:serialNumber
GET /
GET /health
GET /v1/devices/:deviceLibraryIdentifier/registrations/:passTypeIdentifier
GET /v1/passes/:passTypeIdentifier/:serialNumber
POST /api/passes/generate
POST /api/push/update-pass
POST /v1/devices/:deviceLibraryIdentifier/registrations/:passTypeIdentifier/:serialNumber
POST /v1/log
✅ Prueba de escritura en Firestore exitosa
🔍 ====== Nueva Solicitud ======
📍 Método: POST
📍 URL Original: /api/passes/generate
📍 URL Base: 
📍 Ruta: /api/passes/generate
📍 Parámetros: {}
🔒 Headers: {
  "host": "api.leubeautylab.com",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36",
  "content-length": "305",
  "accept": "application/json",
  "accept-encoding": "gzip, br",
  "accept-language": "es,es-419;q=0.9,en;q=0.8,en-US;q=0.7,pl;q=0.6,pt;q=0.5",
  "cdn-loop": "cloudflare; loops=1; subreqs=1",
  "cf-connecting-ip": "187.190.28.44",
  "cf-ew-via": "15",
  "cf-ipcountry": "MX",
  "cf-ray": "8e1a9c6b43f69a51-MEX",
  "cf-visitor": "{\"scheme\":\"https\"}",
  "cf-worker": "onrender.com",
  "content-type": "application/json",
  "origin": "https://admin.leubeautylab.com",
  "priority": "u=1, i",
  "referer": "https://admin.leubeautylab.com/",
  "render-proxy-ttl": "4",
  "rndr-id": "1ce64252-131f-4108",
  "sec-ch-ua": "\"Chromium\";v=\"130\", \"Google Chrome\";v=\"130\", \"Not?A_Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "empty",
  "sec-fetch-mode": "cors",
  "sec-fetch-site": "same-site",
  "true-client-ip": "187.190.28.44",
  "x-forwarded-for": "187.190.28.44, 172.69.164.178, 10.220.20.162",
  "x-forwarded-proto": "https",
  "x-request-start": "1731457384410432"
}
📦 Body: {
  "nombre": "eawe waew",
  "email": "weaweawe@test.com",
  "telefono": "",
  "visitas": 0,
  "ultimaVisita": "2024-11-13T00:22:30.481Z",
  "proximaRecompensa": "Postre Gratis",
  "recompensasCanjeadas": [],
  "id": "P0Kc0Tx4UPh692bDcMZA",
  "lastPassUpdate": "2024-11-13T00:22:31.104Z",
  "passTypeIdentifier": "pass.com.salondenails.loyalty"
}
===============================
🚀 Generando pase para cliente: { clienteId: undefined, nombreCliente: undefined }
❌ Error en la generación del pase: Error: Cannot find module 'archiver'
Require stack:
- /opt/render/project/src/dist/services/passService.js
- /opt/render/project/src/dist/controllers/passController.js
- /opt/render/project/src/dist/index.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1225:15)
    at Module._load (node:internal/modules/cjs/loader:1051:27)
    at Module.require (node:internal/modules/cjs/loader:1311:19)
    at require (node:internal/modules/helpers:179:18)
    at PassService.<anonymous> (/opt/render/project/src/dist/services/passService.js:80:30)
    at Generator.next (<anonymous>)
    at fulfilled (/opt/render/project/src/dist/services/passService.js:6:58)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/opt/render/project/src/dist/services/passService.js',
    '/opt/render/project/src/dist/controllers/passController.js',
    '/opt/render/project/src/dist/index.js'
  ]
}
📤 Respuesta [500]: {"error":"Error interno en la generación del pase"}
📖 Prueba de lectura: exitosa
🧹 Prueba de eliminación de Firestore exitosa